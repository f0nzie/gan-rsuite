---
title: "Load data file, convert to dataframe and plot"
output: html_notebook
---

```{r}
load(file = "s456_e5000_synth_metrics.rda")
# save(synth_data, metrics, file = "s123_e500_synth_metrics.rda")
```


```{r}
convert_metrics_to_df <- function(m) {
    get_epoch <- function(x) {
        # extract key values from the list and return as dataframe
        data.frame(run = x$i, epoch = x$epoch, synth_mean = x$mean_fake, 
                   synth_sd = x$sd_fake) 
    }
    do.call(rbind, lapply(metrics, get_epoch)) # mean and standard deviation table
}

metrics_df <- convert_metrics_to_df(metrics)
```

```{r}
convert_synthetic_to_df <- function(synth) {
    # dataframe for all the sythetic datasets
    do.call(rbind, synth)
}

synthetic_df <- convert_synthetic_to_df(synth_data)
```



```{r fig.height=4.5, fig.width=9}
# facet plot of the mean per sample
library(dplyr)
library(ggplot2)


ggplot(metrics_df, aes(x = epoch, y = synth_mean)) +
    geom_point(alpha = 0.3, size = 0.01, color = "darkgreen") +
    geom_hline(aes(yintercept = 4), linetype = "dotted") + 
    scale_y_continuous(name="Mean", breaks = c(0, 2, 4, 6, 8, 10, 12)) +
    scale_x_continuous(name="epoch", limits = c(0, 6000)) +
    facet_wrap(. ~ run, nrow = 2) +
    labs(title = "Mean")
```

```{r fig.height=4.5, fig.width=9}
# facet plot of the standard deviation per sample
library(dplyr)
library(ggplot2)

ggplot(metrics_df, aes(x = epoch, y = synth_sd)) +
    geom_point(alpha = 0.3, size = 0.01, color = "blue") +
    geom_hline(aes(yintercept = 1), linetype = "dotted") + 
    scale_y_continuous(name="SD", breaks = c(0, 1, 2, 3, 4, 5)) +
    scale_x_continuous(name="epoch", limits = c(0, 6000)) +
    facet_wrap(. ~ run, nrow = 2) +
    labs(title = "Standard Deviation")
```

## Synthetic Data

```{r}
# facets for all synthetic datasets
ggplot(synthetic_df, aes(x = data)) +
    geom_histogram(bins = 50) +
    facet_wrap(. ~ run, nrow=2)
```


```{r}
# run the mean and standard deviation on the synthetic data samples
library(dplyr)

synthetic_df %>% 
    group_by(run) %>% 
    summarise(mean(data), sd(data))
```

