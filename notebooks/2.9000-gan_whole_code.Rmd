---
title: "fivenum in Python"
output: html_notebook
---

**Objective**
- Write a function that replicates the `fivenum` R function to compare the tensors generated in Python to those generated by `rTorch`.

__Motivation__
Use the function to compare Python and R results.

__Recipe__
1. Copy a `fivenum` function
1. Test it agains other similar Python functions
1. Compare the Python version against the R version of `fivenum`
1. Find what changes are required in the original function
1.  

__Sources__
- https://rosettacode.org/wiki/Fivenum#Python 


```{r}
library(rTorch)
```



```{python}
from __future__ import division
import math
import sys
import numpy as np
 
def fivenum(array):
    if isinstance(array, np.ndarray): array = array.tolist()
    n = len(array)
    if n == 0:
        print("you entered an empty array.")
        sys.exit()
    x = sorted(array)
 
    n4 = math.floor((n+3.0)/2.0)/2.0
    d = [1, n4, (n+1)/2, n+1-n4, n]
    sum_array = []
 
    for e in range(5):
        floor = int(math.floor(d[e] - 1))
        ceil = int(math.ceil(d[e] - 1))
        sum_array.append(0.5 * (x[floor] + x[ceil]))
 
    return [round(elem, 8) for elem in sum_array] # round to 9 decimals
    
x = [0.14082834, 0.09748790, 1.73131507, 0.87636009, -1.95059594, 0.73438555, -0.03035726, 1.46675970,
-0.74621349, -0.72588772, 0.63905160, 0.61501527, -0.98983780, -1.00447874, -0.62759469, 0.66206163,
1.04312009, -0.10305385, 0.75775634, 0.32566578]
 
y = fivenum(x)
print(y)    
```

```{python}
type(x)
```

```{python}
if isinstance(x, list): print("list")
```

```{python}
import numpy as np
y = np.random.rand(100)

# [ round(elem, 9) for elem in fivenum(y.tolist()) ]
fivenum(y.tolist())
```

```{python}
type(y)
if isinstance(y, np.ndarray): print("numpy array")
```

```{r}
# fivenum output is identical to custom-made Python function fivenum
fivenum(reticulate::py$y)
```

```{r}
# fivenum output is identical to custom-made Python function fivenum
fivenum(reticulate::py$x)
```


```{r}
quantile(reticulate::py$x)
```

```{python}
import numpy as np
from scipy.stats import scoreatpercentile
from scipy.stats import nanmedian

def fivenum(v):
    """Returns Tukey's five number summary (minimum, lower-hinge, median, upper-hinge, maximum) for the input vector, a list or array of numbers based on 1.5 times the interquartile distance"""
    try:
        np.sum(v)
    except TypeError:
        print('Error: you must provide a list or array of only numbers')
    q1 = scoreatpercentile(v[~np.isnan(v)],25)
    q3 = scoreatpercentile(v[~np.isnan(v)],75)
    iqd = q3-q1
    md = nanmedian(v)
    whisker = 1.5*iqd
    return np.nanmin(v), md-whisker, md, md+whisker, np.nanmax(v),
```

```{python}
import numpy as np

import pandas as pd

s = pd.Series(np.random.rand(100))

s_summary = s.describe()
s_summary
```

```{python}
s_fivenum = s_summary[["min", "50%", "max"]]
s_fivenum
```


```{r}
s <- reticulate::py$s
fivenum(s)
```

```{python}
import numpy as np
np_array = np.array(np.random.random(100))
np.percentile(np_array, [0, 25, 50, 75, 100])
```

```{r}
fivenum(reticulate::py$np_array)
```

```{r}
quantile(reticulate::py$np_array)
```

## applying fivenum to numpy array

```{python}
import numpy as np

np_array = np.array(np.random.random(100))
fivenum(np_array)
```

```{r}
fivenum(reticulate::py$np_array)
```
